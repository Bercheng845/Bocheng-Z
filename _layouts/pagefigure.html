---
layout: pagegallery
---

<head>
    <link href="/assets/js/lightbox.css" rel="stylesheet" />
    <style>
        /* 图片网格样式 */
        .figure-grid {
            margin: 0 auto;
        }

        .figure-grid-sizer,
        .figure-grid-item {
            width: 33.333%;
            /* 3列布局 */
        }

        .figure-grid img,
        .figure-grid a img {
            width: 100%;
            height: auto;
            display: block;
            break-inside: avoid;
        }

        .figure-grid-item img {
            padding: 5px 5px;
        }

        .figure-grid a {
            text-decoration: none;
            border: none;
            outline: none;
        }

        .figure-grid a::after {
            content: none !important;
        }

        .figure-grid-item {
            background-color: rgba(79, 177, 186, 0.5);
            transition: background-color 0.3s ease-in-out;
        }

        .figure-grid-item.loaded {
            background-color: transparent;
        }

        .figure-grid-item img.lozad:not([src]) {
            min-height: 300px;
            visibility: hidden;
        }

        .figure-grid-item img.loaded {
            visibility: visible;
        }

        .image-link img {
            transition: transform 0.3s ease-in-out;
        }

        .image-link img:hover {
            transform: scale(1.05);
        }

        /* 响应式布局 */
        @media screen and (max-width: 768px) {

            .figure-grid-sizer,
            .figure-grid-item {
                width: 50%;
                /* 中等屏幕上是2列 */
            }
        }

        @media screen and (max-width: 480px) {

            .figure-grid-sizer,
            .figure-grid-item {
                width: 100%;
            }
        }
    </style>
</head>

<body>
    <!-- 内容区域 -->
    <div id="content-container">
        <div id="image-section" class="content-section active">
            {{ content }}
        </div>
    </div>

    <!-- 核心脚本 -->
    <script src="/assets/js/lozad.js"></script>
    <script src="/assets/js/masonry.pkgd.min.js"></script>
    <script src="/assets/js/imagesloaded.pkgd.min.js"></script>
    <script src="/assets/js/lightbox-plus-jquery.js"></script>

    <!-- 内联脚本，最简方式实现功能 -->
    <script>
        // 直接执行初始化，不使用任何事件监听
        (function () {
            // 初始化Lightbox
            if (typeof lightbox !== 'undefined') {
                lightbox.option({
                    'resizeDuration': 200,
                    'wrapAround': true,
                    'fitImagesInViewport': true,
                    'disableScrolling': true
                });
            }

            // 设置延迟执行Masonry初始化，确保DOM已加载
            setTimeout(initMasonry, 500);
            setTimeout(initMasonry, 1000);
            setTimeout(initMasonry, 2000);

            // 初始化函数
            function initMasonry() {
                var grid = document.querySelector('.figure-grid');
                if (!grid) return;

                if (grid.classList.contains('masonry-initialized')) return;

                // 初始化Masonry
                if (typeof Masonry !== 'undefined') {
                    var masonry = new Masonry(grid, {
                        itemSelector: '.figure-grid-item',
                        columnWidth: '.figure-grid-sizer',
                        percentPosition: true
                    });

                    grid.classList.add('masonry-initialized');

                    // 初始化懒加载
                    if (typeof lozad !== 'undefined') {
                        var observer = lozad('.lozad', {
                            loaded: function (el) {
                                el.classList.add('loaded');
                                var item = el.closest('.figure-grid-item');
                                if (item) item.classList.add('loaded');

                                // 强制布局
                                masonry.layout();
                            }
                        });
                        observer.observe();
                    }

                    // 初始化图片加载监听
                    if (typeof imagesLoaded !== 'undefined') {
                        imagesLoaded(grid).on('progress', function () {
                            masonry.layout();
                        });
                    }
                }
            }
        })();

        // 在URL变化时重新初始化（针对SPA网站）
        var currentUrl = location.href;
        setInterval(function () {
            if (location.href !== currentUrl) {
                currentUrl = location.href;
                // 延迟重新初始化
                setTimeout(function () {
                    var grid = document.querySelector('.figure-grid');
                    if (grid) {
                        grid.classList.remove('masonry-initialized');
                        // 强制重新初始化
                        var event = new Event('DOMContentLoaded');
                        document.dispatchEvent(event);
                    }
                }, 500);
            }
        }, 500);
    </script>
</body>